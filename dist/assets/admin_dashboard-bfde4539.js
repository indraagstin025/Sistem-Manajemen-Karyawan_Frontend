import"./input-ac4e21e1.js";import{a as m,d as u}from"./AuthServices-0f733033.js";import{Q as i}from"./qrCodeHandler-3c60f548.js";import{i as g}from"./logoutHandler-a2e70173.js";import{T as p}from"./toastify-3acd0462.js";/* empty css                 */import"./AttendanceServices-9bf2f837.js";document.addEventListener("DOMContentLoaded",()=>{feather.replace();const n=(t,a="success")=>{const r={success:"linear-gradient(to right, #22c55e, #16a34a)",error:"linear-gradient(to right, #ef4444, #dc2626)",info:"linear-gradient(to right, #3b82f6, #2563eb)"}[a];p({text:t,duration:3e3,close:!0,gravity:"top",position:"right",style:{background:r,borderRadius:"8px"}}).showToast()},d=async()=>{const t=document.getElementById("userAvatar");try{const a=await m.getCurrentUser();a&&a.photo_url&&t?t.src=a.photo_url:t&&(t.src="/assets/default-avatar.png")}catch(a){console.error("Gagal memuat profil pengguna:",a),t&&(t.src="/assets/default-avatar.png")}},c=async()=>{const t=document.getElementById("totalKaryawan"),a=document.getElementById("karyawanAktif"),r=document.getElementById("totalDepartemen"),s=document.getElementById("departmentChart");try{const e=await u.getDashboardStats();t&&(t.innerText=e.total_karyawan||0),a&&(a.innerText=e.karyawan_aktif||0),r&&(r.innerText=e.total_departemen||0),s&&e.distribusi_departemen&&(window.myDepartmentChart&&window.myDepartmentChart.destroy(),window.myDepartmentChart=new Chart(s,{type:"bar",data:{labels:e.distribusi_departemen.map(o=>o.department),datasets:[{label:"Jumlah Karyawan",data:e.distribusi_departemen.map(o=>o.count),backgroundColor:["rgba(20, 184, 166, 0.8)","rgba(59, 130, 246, 0.8)","rgba(249, 115, 22, 0.8)"],borderColor:["#0d9488","#2563eb","#d97706"],borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}}))}catch(e){console.error("Gagal memuat data dashboard:",e),n("Gagal memuat data dashboard.","error")}},l=()=>{const t=document.getElementById("userDropdown"),a=document.getElementById("dropdownMenu");t==null||t.addEventListener("click",r=>{r.stopPropagation(),a.classList.toggle("active")}),document.addEventListener("click",()=>{a==null||a.classList.remove("active")}),i.initialize({toastCallback:n}),g({preLogoutCallback:i.close})};(()=>{l(),c(),d()})()});
