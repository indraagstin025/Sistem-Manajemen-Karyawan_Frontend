import"./input-d134dd88.js";import{C as v,i as f,a as g,c as w,l as x,W as m}from"./WorkScheduleServices-009fab0e.js";import{a as b}from"./AuthServices-f47c4eb9.js";import{g as $}from"./photoUtils-240b8068.js";import{S as d,i as k}from"./logoutHandler-87b1a96c.js";import{i as T}from"./sidebarHandler-d6522c99.js";document.addEventListener("DOMContentLoaded",()=>{const p=document.getElementById("my-calendar"),s=document.getElementById("userAvatar");let i;const u=async()=>{try{const e=b.getCurrentUser();if(!e)return;const t=await $(e.id,e.name);s&&(s.src=t,s.alt=e.name)}catch(e){console.error("Gagal memuat foto header",e)}},c={left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek"},h={left:"prev,next",center:"title",right:"today"};i=new v(p,{plugins:[f,g,w],locale:x,initialView:window.innerWidth<768?"listMonth":"dayGridMonth",headerToolbar:window.innerWidth<768?h:c,height:"auto",editable:!1,selectable:!1,eventSources:[{events:async e=>{try{const o=(await m.getMyWorkSchedules()).data||[],a={};return o.forEach(r=>{a[r.date]||(a[r.date]=[]),a[r.date].push(r)}),Object.entries(a).map(([r,n])=>({id:`schedule-${r}`,title:`Jadwal Kerja: ${n[0].start_time} - ${n[0].end_time}`,start:`${r}T${n[0].start_time}`,end:`${r}T${n[0].end_time}`,extendedProps:{items:n,type:"schedule"},display:"block",className:"fc-event-work-schedule"}))}catch(t){return console.error("Error fetching work schedules:",t),d.fire("Gagal memuat jadwal kerja",t.message,"error"),[]}}},{events:async e=>{try{const t=e.start.getFullYear();return(await m.getHolidays(t)||[]).map(a=>({id:`holiday-${a.Date}`,title:a.Name,start:a.Date,allDay:!0,display:"block",className:"fc-event-holiday",extendedProps:{type:"holiday"}}))}catch(t){return console.error("Error fetching holidays:",t),[]}}}],eventContent:e=>{if(e.event.extendedProps.type==="schedule")return e.view.type.startsWith("list")?{html:`<div class="fc-list-event-title">${e.event.title}</div>`}:{html:'<div class="fc-event-dot"></div>'};if(e.event.extendedProps.type==="holiday")return{html:`<div class="fc-event-title-holiday">${e.event.title}</div>`}},eventClick:e=>{const t=e.event.extendedProps.type;if(t==="holiday"){d.fire({title:"Informasi Hari Libur",html:`<p style="font-size: 1.1rem;">${e.event.title}</p>`,icon:"info",confirmButtonText:"Tutup"});return}if(t==="schedule"){const{start:o,extendedProps:a}=e.event,r=o.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),n=a.items.map((l,y)=>`
                    <div style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee;">
                        <p style="margin: 0; font-weight: bold;">Jadwal ${y+1}:</p>
                        <p style="margin: 5px 0;"><strong>Jam:</strong> ${l.start_time} - ${l.end_time}</p>
                        <p style="margin: 5px 0;"><strong>Catatan:</strong> ${l.note||"Tanpa catatan"}</p>
                    </div>
                `).join("");d.fire({title:"Detail Jadwal Kerja",html:`<div style="text-align: left; max-height: 300px; overflow-y: auto; padding-right: 10px;"><p style="margin-bottom: 15px;"><b>Tanggal:</b> ${r}</p>${n}</div>`,icon:"info",confirmButtonText:"Tutup"})}},eventMouseEnter:e=>{e.el.title=e.event.title}}),window.addEventListener("resize",()=>{window.innerWidth<768?(i.changeView("listMonth"),i.setOption("headerToolbar",h)):(i.changeView("dayGridMonth"),i.setOption("headerToolbar",c))}),T(),k(),u(),i.render()});
