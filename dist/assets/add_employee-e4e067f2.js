import"./input-ac4e21e1.js";import{u as b}from"./UserServices-9109671c.js";import{d as w}from"./DepartemenServices-5d2df75f.js";import{a as h}from"./AuthServices-0f733033.js";import{i as L}from"./sidebarHandler-d6522c99.js";import{i as k}from"./logoutHandler-a2e70173.js";import{Q as p}from"./qrCodeHandler-3c60f548.js";import{T as B}from"./toastify-3acd0462.js";/* empty css                 */import"./AttendanceServices-9bf2f837.js";let n={name:!1,email:!1,password:!1,position:!1,department:!1,salary:!1};function c(){const t=document.getElementById("submitButton");if(!t)return;const o=Object.values(n).every(i=>i);t.disabled=!o,o?(t.classList.remove("bg-gray-400","cursor-not-allowed"),t.classList.add("bg-teal-600","hover:bg-teal-700")):(t.classList.add("bg-gray-400","cursor-not-allowed"),t.classList.remove("bg-teal-600","hover:bg-teal-700"))}function x(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}function D(t){return t.trim().length>=2&&/^[a-zA-Z\s]+$/.test(t.trim())}function v(){const t=document.getElementById("name"),o=document.getElementById("email"),i=document.getElementById("password"),m=document.getElementById("position"),d=document.getElementById("department"),l=document.getElementById("base_salary");t==null||t.addEventListener("input",function(){const e=document.getElementById("nameError");D(this.value)?(n.name=!0,e.classList.add("hidden")):(n.name=!1,e.textContent="Nama harus minimal 2 karakter dan hanya huruf.",e.classList.remove("hidden")),c()}),o==null||o.addEventListener("input",function(){const e=document.getElementById("emailError");x(this.value)?(n.email=!0,e.classList.add("hidden")):(n.email=!1,e.textContent="Format email tidak valid.",e.classList.remove("hidden")),c()}),i==null||i.addEventListener("input",function(){const e=document.getElementById("passwordError");this.value.length<6?(n.password=!1,e.textContent="Password minimal 8 karakter dan harus menggunakan Campuran Huruf Besar.",e.classList.remove("hidden")):(n.password=!0,e.classList.add("hidden")),c()}),m==null||m.addEventListener("input",function(){const e=document.getElementById("positionError");this.value.trim().length<2?(n.position=!1,e.textContent="Posisi wajib diisi.",e.classList.remove("hidden")):(n.position=!0,e.classList.add("hidden")),c()}),d==null||d.addEventListener("change",function(){const e=document.getElementById("departmentError");this.value?(n.department=!0,e.classList.add("hidden")):(n.department=!1,e.textContent="Departemen wajib dipilih.",e.classList.remove("hidden")),c()}),l==null||l.addEventListener("input",function(){const e=document.getElementById("salaryError"),f=parseFloat(this.value);isNaN(f)||f<1?(n.salary=!1,e.textContent="Gaji harus angka positif.",e.classList.remove("hidden")):(n.salary=!0,e.classList.add("hidden")),c()}),c()}function C(){return Object.values(n).every(t=>t)}document.addEventListener("DOMContentLoaded",async()=>{L(),v(),p.initialize({toastCallback:(a,r)=>{e(a,r)}}),k({preLogoutCallback:()=>{typeof p<"u"&&p.close&&p.close()}});const t=document.getElementById("addEmployeeForm"),o=document.getElementById("department"),i=document.getElementById("cancelButton"),m=document.querySelectorAll("#logoutButton"),d=document.getElementById("password"),l=document.getElementById("togglePassword");l&&d&&l.addEventListener("click",()=>{const a=d.getAttribute("type")==="password"?"text":"password";d.setAttribute("type",a);const r=l.querySelector("i");a==="password"?r.setAttribute("data-feather","eye-off"):r.setAttribute("data-feather","eye"),feather.replace()});function e(a,r="success"){const s={success:"linear-gradient(to right, #10b981, #14b8a6)",error:"linear-gradient(to right, #ef4444, #dc2626)",warning:"linear-gradient(to right, #f97316, #ea580c)"},u=s[r]||s.error;B({text:a,duration:r==="success"?3e3:-1,close:!0,gravity:"top",position:"center",stopOnFocus:!0,style:{background:u,borderRadius:"8px",padding:"20px 24px",boxShadow:"0 5px 15px rgba(0,0,0,0.3)",maxWidth:"400px",textAlign:"center"},modal:!0}).showToast()}await(async()=>{try{const a=await w.getAllDepartments();o.innerHTML='<option value="">Pilih Departemen</option>',a.forEach(r=>{const s=document.createElement("option");s.value=r.name,s.textContent=r.name,o.appendChild(s)})}catch(a){console.error("Gagal memuat daftar departemen:",a),e("Gagal memuat daftar departemen.","error"),a.status===401&&h.logout()}})(),t.addEventListener("submit",async a=>{var y;if(a.preventDefault(),!C()){e("Harap perbaiki semua kesalahan pada form.","error");return}const r=new FormData(t),s=Object.fromEntries(r.entries());s.role="karyawan",s.base_salary=parseFloat(s.base_salary);const u=localStorage.getItem("token");if(!u){h.logout();return}try{await b.registerUser(s,u),e("Karyawan baru berhasil didaftarkan!","success"),t.reset(),v(),setTimeout(()=>{window.location.href="/src/pages/Admin/manage_employees.html"},2e3)}catch(g){console.error("Gagal mendaftarkan karyawan:",g);const E=((y=g.details)==null?void 0:y.error)||g.message||"Terjadi kesalahan server.";e(E,"error")}}),i==null||i.addEventListener("click",()=>{confirm("Anda yakin ingin membatalkan? Perubahan tidak akan disimpan.")&&(window.location.href="/src/pages/Admin/manage_employees.html")}),m.forEach(a=>{a==null||a.addEventListener("click",r=>{r.preventDefault(),h.logout()})})});
