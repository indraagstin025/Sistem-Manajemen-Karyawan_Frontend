import"./input-2ed11044.js";import{C as h,i as y,a as g,l as f,W as c}from"./WorkScheduleServices-b10e58c7.js";import{a as v}from"./AuthServices-f47c4eb9.js";import{g as x}from"./photoUtils-240b8068.js";import{S as l,i as b}from"./logoutHandler-87b1a96c.js";import{i as $}from"./sidebarHandler-d6522c99.js";document.addEventListener("DOMContentLoaded",()=>{const m=document.getElementById("my-calendar"),i=document.getElementById("userAvatar");let d;const p=async()=>{try{const e=v.getCurrentUser();if(!e)return;const t=await x(e.id,e.name);i&&(i.src=t,i.alt=e.name)}catch(e){console.error("Gagal memuat foto header",e)}};d=new h(m,{plugins:[y,g],initialView:"dayGridMonth",locale:f,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek"},editable:!1,selectable:!1,eventSources:[{events:async e=>{try{const o=(await c.getMyWorkSchedules()).data||[],a={};return o.forEach(r=>{a[r.date]||(a[r.date]=[]),a[r.date].push(r)}),Object.entries(a).map(([r,n])=>({id:`schedule-${r}`,title:`Jadwal Kerja: ${n[0].start_time} - ${n[0].end_time}`,start:`${r}T${n[0].start_time}`,end:`${r}T${n[0].end_time}`,extendedProps:{items:n,type:"schedule"},display:"block",className:"fc-event-work-schedule"}))}catch(t){return console.error("Error fetching work schedules:",t),l.fire("Gagal memuat jadwal kerja",t.message,"error"),[]}}},{events:async e=>{try{const t=e.start.getFullYear();return(await c.getHolidays(t)||[]).map(a=>({id:`holiday-${a.Date}`,title:a.Name,start:a.Date,allDay:!0,display:"block",className:"fc-event-holiday",extendedProps:{type:"holiday"}}))}catch(t){return console.error("Error fetching holidays:",t),[]}}}],eventContent:e=>{if(e.event.extendedProps.type==="schedule")return{html:'<div class="fc-event-dot"></div>'};if(e.event.extendedProps.type==="holiday")return{html:`<div class="fc-event-title-holiday">${e.event.title}</div>`}},eventClick:e=>{const t=e.event.extendedProps.type;if(t==="holiday"){l.fire({title:"Informasi Hari Libur",html:`<p style="font-size: 1.1rem;">${e.event.title}</p>`,icon:"info",confirmButtonText:"Tutup"});return}if(t==="schedule"){const{start:o,extendedProps:a}=e.event,r=o.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),n=a.items.map((s,u)=>`
            <div style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee;">
                <p style="margin: 0; font-weight: bold;">Jadwal ${u+1}:</p>
                <p style="margin: 5px 0;"><strong>Jam:</strong> ${s.start_time} - ${s.end_time}</p>
                <p style="margin: 5px 0;"><strong>Catatan:</strong> ${s.note||"Tanpa catatan"}</p>
            </div>
        `).join("");l.fire({title:"Detail Jadwal Kerja",html:`<div style="text-align: left; max-height: 300px; overflow-y: auto; padding-right: 10px;"><p style="margin-bottom: 15px;"><b>Tanggal:</b> ${r}</p>${n}</div>`,icon:"info",confirmButtonText:"Tutup"})}},eventMouseEnter:e=>{e.el.title=e.event.title}}),$(),b(),p(),d.render()});
