import"./input-d134dd88.js";import{C as v,i as f,a as w,c as x,l as b,W as u}from"./WorkScheduleServices-963c431a.js";import{a as $}from"./AuthServices-f47c4eb9.js";import{g as D}from"./photoUtils-240b8068.js";import{S as c,i as k}from"./logoutHandler-87b1a96c.js";import{i as T}from"./sidebarHandler-d6522c99.js";document.addEventListener("DOMContentLoaded",()=>{const y=document.getElementById("my-calendar"),d=document.getElementById("userAvatar");let i;const h=e=>{const t=new Date(e);let r=""+(t.getMonth()+1),n=""+t.getDate();const l=t.getFullYear();return r.length<2&&(r="0"+r),n.length<2&&(n="0"+n),[l,r,n].join("-")},g=async()=>{try{const e=$.getCurrentUser();if(!e)return;const t=await D(e.id,e.name);d&&(d.src=t,d.alt=e.name)}catch(e){console.error("Gagal memuat foto header",e)}},m={left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek"},p={left:"prev,next",center:"title",right:"today"};i=new v(y,{plugins:[f,w,x],locale:b,initialView:window.innerWidth<768?"listMonth":"dayGridMonth",headerToolbar:window.innerWidth<768?p:m,height:"auto",editable:!1,selectable:!1,eventSources:[{events:async e=>{try{const t=h(e.start),r=h(e.end),l=(await u.getMyWorkSchedules(t,r)).data||[],s={};return l.forEach(a=>{s[a.date]||(s[a.date]=[]),s[a.date].push(a)}),Object.entries(s).map(([a,o])=>({id:`schedule-${a}`,title:`Jadwal Kerja: ${o[0].start_time} - ${o[0].end_time}`,start:`${a}T${o[0].start_time}`,end:`${a}T${o[0].end_time}`,extendedProps:{items:o,type:"schedule"},display:"block",className:"fc-event-work-schedule"}))}catch(t){return console.error("Error fetching work schedules:",t),c.fire("Gagal memuat jadwal kerja",t.message,"error"),[]}}},{events:async e=>{try{const t=e.start.getFullYear();return(await u.getHolidays(t)||[]).map(n=>({id:`holiday-${n.Date}`,title:n.Name,start:n.Date,allDay:!0,display:"block",className:"fc-event-holiday",extendedProps:{type:"holiday"}}))}catch(t){return console.error("Error fetching holidays:",t),[]}}}],eventContent:e=>{if(e.event.extendedProps.type==="schedule")return e.view.type.startsWith("list")?{html:`<div class="fc-list-event-title">${e.event.title}</div>`}:{html:'<div class="fc-event-dot"></div>'};if(e.event.extendedProps.type==="holiday")return{html:`<div class="fc-event-title-holiday">${e.event.title}</div>`}},eventClick:e=>{const t=e.event.extendedProps.type;if(t==="holiday"){c.fire({title:"Informasi Hari Libur",html:`<p style="font-size: 1.1rem;">${e.event.title}</p>`,icon:"info",confirmButtonText:"Tutup"});return}if(t==="schedule"){const{start:r,extendedProps:n}=e.event,l=r.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=n.items.map((a,o)=>`
                    <div style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee;">
                        <p style="margin: 0; font-weight: bold;">Jadwal ${o+1}:</p>
                        <p style="margin: 5px 0;"><strong>Jam:</strong> ${a.start_time} - ${a.end_time}</p>
                        <p style="margin: 5px 0;"><strong>Catatan:</strong> ${a.note||"Tanpa catatan"}</p>
                    </div>
                `).join("");c.fire({title:"Detail Jadwal Kerja",html:`<div style="text-align: left; max-height: 300px; overflow-y: auto; padding-right: 10px;"><p style="margin-bottom: 15px;"><b>Tanggal:</b> ${l}</p>${s}</div>`,icon:"info",confirmButtonText:"Tutup"})}},eventMouseEnter:e=>{e.el.title=e.event.title}}),window.addEventListener("resize",()=>{window.innerWidth<768?(i.changeView("listMonth"),i.setOption("headerToolbar",p)):(i.changeView("dayGridMonth"),i.setOption("headerToolbar",m))}),T(),k(),g(),i.render()});
