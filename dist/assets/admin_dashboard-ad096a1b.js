import"./input-214ac174.js";import{a as u,d as g}from"./AuthServices-0f733033.js";import{Q as d}from"./qrCodeHandler-69007ccb.js";import{i as p}from"./logoutHandler-0fd76589.js";import"./AttendanceServices-788ac82a.js";import"./sweetalert2.esm.all-9d2ad45a.js";document.addEventListener("DOMContentLoaded",()=>{feather.replace();const n=(t,a="success")=>{const r={success:"linear-gradient(to right, #22c55e, #16a34a)",error:"linear-gradient(to right, #ef4444, #dc2626)",info:"linear-gradient(to right, #3b82f6, #2563eb)"}[a];Toastify({text:t,duration:3e3,close:!0,gravity:"top",position:"right",style:{background:r,borderRadius:"8px"}}).showToast()},c=async()=>{const t=document.getElementById("userAvatar");try{const a=await u.getCurrentUser();a&&a.photo_url&&t?t.src=a.photo_url:t&&(t.src="/assets/default-avatar.png")}catch(a){console.error("Gagal memuat profil pengguna:",a),t&&(t.src="/assets/default-avatar.png")}},l=async()=>{const t=document.getElementById("totalKaryawan"),a=document.getElementById("karyawanAktif"),r=document.getElementById("karyawanCuti"),s=document.getElementById("totalDepartemen"),i=document.getElementById("departmentChart");try{const e=await g.getDashboardStats();t&&(t.innerText=e.total_karyawan||0),a&&(a.innerText=e.karyawan_aktif||0),r&&(r.innerText=e.karyawan_cuti||0),s&&(s.innerText=e.total_departemen||0),i&&e.distribusi_departemen&&(window.myDepartmentChart&&window.myDepartmentChart.destroy(),window.myDepartmentChart=new Chart(i,{type:"bar",data:{labels:e.distribusi_departemen.map(o=>o.department),datasets:[{label:"Jumlah Karyawan",data:e.distribusi_departemen.map(o=>o.count),backgroundColor:["rgba(20, 184, 166, 0.8)","rgba(59, 130, 246, 0.8)","rgba(249, 115, 22, 0.8)"],borderColor:["#0d9488","#2563eb","#d97706"],borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}}))}catch(e){console.error("Gagal memuat data dashboard:",e),n("Gagal memuat data dashboard.","error")}},m=()=>{const t=document.getElementById("userDropdown"),a=document.getElementById("dropdownMenu");t==null||t.addEventListener("click",r=>{r.stopPropagation(),a.classList.toggle("active")}),document.addEventListener("click",()=>{a==null||a.classList.remove("active")}),d.initialize({toastCallback:n}),p({preLogoutCallback:d.close})};(()=>{m(),l(),c()})()});
